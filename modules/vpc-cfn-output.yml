---
# Collect outputs of vpn cloudformation stack

- name: "vpc-cfn-output - {{ root_name }} - Collect  {{ vpc_cfn_stack }} cloudformation stack facts"
  amazon.aws.cloudformation_info:
    stack_name: "{{ vpc_cfn_stack }}"
  register: vpc_stack_info

# - debug:
#     var: vpc_stack_info

- name: "vpc-cfn-output - {{ root_name }} - set parameters values"
  set_fact:
    InfrastructureName: "{{ infra_name['stdout'] }}"
    HostedZoneId: "{{ hosted_zone_output['stdout'] }}"
    PrivateSubnetIds: "{{ vpc_stack_info.cloudformation[ stack_name ][ 'stack_outputs' ][ 'PrivateSubnetIds' ] }}"
    PublicRouteTableId: "{{ vpc_stack_info.cloudformation[ stack_name ][ 'stack_outputs' ][ 'PublicRouteTableId' ] }}"
    PublicSubnetIds: "{{ vpc_stack_info.cloudformation[ stack_name ][ 'stack_outputs' ][ 'PublicSubnetIds' ] }}"
    VpcId: "{{ vpc_stack_info.cloudformation[ stack_name ][ 'stack_outputs' ][ 'VpcId' ] }}"